<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Padel Club Investment Planner</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/frappe-gantt@0.6.2/dist/frappe-gantt.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/frappe-gantt@0.6.2/dist/frappe-gantt.css"/>
  <script src="script.js" defer></script>
</head>
<body>
  <header>
    <img src="logo.png" alt="Club Logo" id="clubLogo" />
    <h1>Padel Club Investment Planner</h1>
  </header>
  <nav class="tabs" role="tablist">
    <button type="button" id="btnPadel" data-tab="padel" class="active" aria-controls="padel">Padel</button>
    <button type="button" id="btnGym" data-tab="gym" aria-controls="gym">Gym</button>
    <button type="button" id="btnPnl" data-tab="pnl" aria-controls="pnl">Profit &amp; Loss</button>
    <button type="button" id="btnRoi" data-tab="roi" aria-controls="roi">ROI</button>
    <button type="button" id="btnScenarios" data-tab="scenarios" aria-controls="scenarios">Scenarios</button>
    <button type="button" id="btnSummary" data-tab="summary" aria-controls="summary">Summary</button>
    <button type="button" id="btnGantt" data-tab="gantt" aria-controls="gantt">Gantt</button>
    <button type="button" id="btnFiles" onclick="window.open('https://aloc23.github.io/pci_project_file_viewer/', '_blank')">Files</button>
  </nav>
  <main>
    <!-- Padel Tab -->
    <section id="padel" class="tab-content">
      <h2>Padel Investment &amp; Revenue</h2>
      <div class="section-group">
        <h3>Investment Inputs</h3>
        <label>Ground Cost: <input id="padelGround" type="number" value="50000"></label>
        <label>Structure Cost: <input id="padelStructure" type="number" value="120000"></label>
        <label>Number of Courts: <input id="padelCourts" type="number" value="3"></label>
        <label>Per Court Cost: <input id="padelCourtCost" type="number" value="18000"></label>
        <label>Amenities: <input id="padelAmenities" type="number" value="20000"></label>
      </div>
     <div class="section-group">
  <h3>Utilization Inputs</h3>
  <label>
    Peak Hours/Day:
    <input id="padelPeakHours" type="range" min="0" max="12" value="4" step="0.5" oninput="peakHoursVal.value=this.value; calculatePadel()">
    <input id="peakHoursVal" type="number" min="0" max="12" value="4" step="0.5" oninput="padelPeakHours.value=this.value; calculatePadel()">
  </label>
  <label>
    Peak Utilization (%):
    <input id="padelPeakUtil" type="range" min="0" max="100" value="70" step="1" oninput="peakUtilVal.value=this.value; calculatePadel()">
    <input id="peakUtilVal" type="number" min="0" max="100" value="70" step="1" oninput="padelPeakUtil.value=this.value; calculatePadel()">
  </label>
  <label>
    Peak Rate:
    <input id="padelPeakRate" type="range" min="0" max="100" value="40" step="1" oninput="peakRateVal.value=this.value; calculatePadel()">
    <input id="peakRateVal" type="number" min="0" max="100" value="40" step="1" oninput="padelPeakRate.value=this.value; calculatePadel()">
  </label>
  <label>
    Off Hours/Day:
    <input id="padelOffHours" type="range" min="0" max="12" value="2" step="0.5" oninput="offHoursVal.value=this.value; calculatePadel()">
    <input id="offHoursVal" type="number" min="0" max="12" value="2" step="0.5" oninput="padelOffHours.value=this.value; calculatePadel()">
  </label>
  <label>
    Off Utilization (%):
    <input id="padelOffUtil" type="range" min="0" max="100" value="35" step="1" oninput="offUtilVal.value=this.value; calculatePadel()">
    <input id="offUtilVal" type="number" min="0" max="100" value="35" step="1" oninput="padelOffUtil.value=this.value; calculatePadel()">
  </label>
  <label>
    Off Rate:
    <input id="padelOffRate" type="range" min="0" max="100" value="25" step="1" oninput="offRateVal.value=this.value; calculatePadel()">
    <input id="offRateVal" type="number" min="0" max="100" value="25" step="1" oninput="padelOffRate.value=this.value; calculatePadel()">
  </label>
  <label>
    Days/Week: <input id="padelDays" type="number" value="7">
  </label>
  <label>
    Weeks/Year: <input id="padelWeeks" type="number" value="52">
  </label>
</div>
      <div class="section-group">
        <h3>Operating Costs</h3>
        <label>Utilities/year: <input id="padelUtil" type="number" value="5000"></label>
        <label>Insurance/year: <input id="padelInsure" type="number" value="2500"></label>
        <label>Maintenance/year: <input id="padelMaint" type="number" value="3000"></label>
        <label>Marketing/year: <input id="padelMarket" type="number" value="4000"></label>
        <label>Admin/year: <input id="padelAdmin" type="number" value="3500"></label>
        <label>Cleaning/year: <input id="padelClean" type="number" value="2000"></label>
        <label>Misc/year: <input id="padelMisc" type="number" value="1000"></label>
      </div>
      <div class="section-group">
        <h3>Staffing</h3>
        <label>Full-time Manager: <input id="padelFtMgr" type="number" value="1"></label>
        <label>FT Mgr Salary: <input id="padelFtMgrSal" type="number" value="35000"></label>
        <label>Full-time Reception: <input id="padelFtRec" type="number" value="1"></label>
        <label>FT Rec Salary: <input id="padelFtRecSal" type="number" value="21000"></label>
        <label>Full-time Coach: <input id="padelFtCoach" type="number" value="1"></label>
        <label>FT Coach Salary: <input id="padelFtCoachSal" type="number" value="25000"></label>
        <label>Part-time Coach: <input id="padelPtCoach" type="number" value="1"></label>
        <label>PT Coach Salary: <input id="padelPtCoachSal" type="number" value="12000"></label>
        <label>Additional Staff: <input id="padelAddStaff" type="number" value="0"></label>
        <label>Add Staff Salary: <input id="padelAddStaffSal" type="number" value="0"></label>
      </div>
      <div id="padelSummary" class="summary" aria-live="polite"></div>
      <button id="calculatePadelBtn">Calculate Padel</button>
    </section>
    <!-- Gym Tab -->
    <section id="gym" class="tab-content hidden">
      <h2>Gym Investment &amp; Revenue</h2>
      <div class="section-group">
        <h3>Investment Inputs</h3>
        <label>Equipment: <input id="gymEquip" type="number" value="35000"></label>
        <label>Flooring: <input id="gymFloor" type="number" value="12000"></label>
        <label>Amenities: <input id="gymAmen" type="number" value="8000"></label>
      </div>
      <div class="section-group">
        <h3>Utilization Inputs</h3>
        <label>Weekly Members: <input id="gymWeekMembers" type="number" value="30"></label>
        <label>Weekly Fee: <input id="gymWeekFee" type="number" value="25"></label>
        <label>Monthly Members: <input id="gymMonthMembers" type="number" value="20"></label>
        <label>Monthly Fee: <input id="gymMonthFee" type="number" value="60"></label>
        <label>Annual Members: <input id="gymAnnualMembers" type="number" value="10"></label>
        <label>Annual Fee: <input id="gymAnnualFee" type="number" value="500"></label>
        <label><input type="checkbox" id="gymRamp"> Use Ramp-up</label>
        <label>Ramp Months: <input id="rampDuration" type="number" value="3" min="1" max="12"></label>
        <label>Ramp Effect (%): <input id="rampEffect" type="number" value="50" min="0" max="100"></label>
      </div>
      <div class="section-group">
        <h3>Operating Costs</h3>
        <label>Utilities/year: <input id="gymUtil" type="number" value="3000"></label>
        <label>Insurance/year: <input id="gymInsure" type="number" value="1800"></label>
        <label>Maintenance/year: <input id="gymMaint" type="number" value="2500"></label>
        <label>Marketing/year: <input id="gymMarket" type="number" value="3000"></label>
        <label>Admin/year: <input id="gymAdmin" type="number" value="2000"></label>
        <label>Cleaning/year: <input id="gymClean" type="number" value="1500"></label>
        <label>Misc/year: <input id="gymMisc" type="number" value="1000"></label>
      </div>
      <div class="section-group">
        <h3>Staffing</h3>
        <label>Full-time Trainer: <input id="gymFtTrainer" type="number" value="1"></label>
        <label>FT Trainer Salary: <input id="gymFtTrainerSal" type="number" value="22000"></label>
        <label>Part-time Trainer: <input id="gymPtTrainer" type="number" value="1"></label>
        <label>PT Trainer Salary: <input id="gymPtTrainerSal" type="number" value="9000"></label>
        <label>Additional Staff: <input id="gymAddStaff" type="number" value="0"></label>
        <label>Add Staff Salary: <input id="gymAddStaffSal" type="number" value="0"></label>
      </div>
      <div id="gymSummary" class="summary" aria-live="polite"></div>
      <button id="calculateGymBtn">Calculate Gym</button>
    </section>
    <!-- Profit & Loss Tab -->
    <section id="pnl" class="tab-content hidden">
      <h2>Profit &amp; Loss</h2>
      <label class="include-gym-toggle">
        <input type="checkbox" id="includeGym" checked>
        Include Gym in calculations
      </label>
      <div id="pnlSummary" class="summary" aria-live="polite"></div>
      <canvas id="pnlChart"></canvas>
      <canvas id="profitTrendChart"></canvas>
      <canvas id="costPieChart"></canvas>
      <details>
        <summary>Monthly Breakdown</summary>
        <table id="monthlyBreakdown" class="breakdown-table">
          <thead>
            <tr><th>Month</th><th>Revenue</th><th>Costs</th><th>Profit</th></tr>
          </thead>
          <tbody></tbody>
        </table>
      </details>
      <details>
        <summary>Monthly Cash Flow</summary>
        <table id="cashFlowTable" class="breakdown-table">
          <thead>
            <tr><th>Month</th><th>Opening Balance</th><th>Cash In</th><th>Cash Out</th><th>Closing Balance</th></tr>
          </thead>
          <tbody></tbody>
        </table>
      </details>
    </section>
    <!-- ROI Tab -->
    <section id="roi" class="tab-content hidden">
      <h2>Return on Investment</h2>
      <label class="include-gym-toggle">
        <input type="checkbox" id="includeGymROI" checked>
        Include Gym in calculations
      </label>
      <div id="yearsToROIText" class="roi-summary"></div>
      <div class="roi-controls">
        <label for="roiRevAdjust">Revenue Adjustment (%)
          <input type="range" id="roiRevAdjust" min="80" max="120" value="100" oninput="updateROIAdjustmentLabel(this.value)" />
          <span id="roiRevAdjustLabel">100%</span>
        </label>
        <label for="roiCostAdjust">Cost Adjustment (%)
          <input type="range" id="roiCostAdjust" min="80" max="120" value="100" oninput="updateROIAdjustmentLabel(this.value)" />
          <span id="roiCostAdjustLabel">100%</span>
        </label>
      </div>
      <canvas id="roiLineChart"></canvas>
      <canvas id="roiBarChart"></canvas>
      <canvas id="roiPieChart"></canvas>
      <canvas id="roiBreakEvenChart"></canvas>
      <details>
        <summary>Payback Period Table</summary>
        <table id="paybackTable" class="breakdown-table">
          <thead><tr><th>Year</th><th>Cumulative Profit (€)</th></tr></thead>
          <tbody></tbody>
        </table>
      </details>
      <div id="roiKPIs" class="summary"></div>
      <h3>Tornado Sensitivity Chart</h3>
      <canvas id="tornadoChart"></canvas>
    </section>
    <!-- Scenarios Tab -->
    <section id="scenarios" class="tab-content hidden">
      <h2>Scenarios</h2>
      <form id="scenarioForm">
        <input type="text" id="scenarioName" placeholder="Scenario name" required />
        <button type="submit">Save Current Scenario</button>
      </form>
      <div id="scenarioList"></div>
      <div id="scenarioDiffContainer"></div>
    </section>
    <!-- Summary Report Tab -->
    <section id="summary" class="tab-content hidden">
      <h2>Summary Report</h2>
      <button onclick="exportPDF()">Export as PDF</button>
      <button onclick="exportExcel()">Export as Excel</button>
      <div id="reportContent"></div>
    </section>
    <!-- Gantt Tab -->
    <section id="gantt" class="tab-content hidden">
      <h2>Project Timeline (Gantt)</h2>
      <p style="color:#888; margin-bottom:1rem;">
        Edit the timeline below: add, edit, or remove tasks. Changes update instantly.
      </p>
      <form id="ganttTaskForm" class="section-group" style="margin-bottom:1rem;">
        <input type="hidden" id="ganttEditId" value="">
        <label>Task Name: <input type="text" id="ganttTaskName" required></label>
        <label>Start Date: <input type="date" id="ganttTaskStart" required></label>
        <label>End Date: <input type="date" id="ganttTaskEnd" required></label>
        <label>Progress (%): <input type="number" id="ganttTaskProgress" min="0" max="100" value="0"></label>
        <button type="submit" id="ganttTaskSaveBtn">Add/Update Task</button>
        <button type="button" id="ganttTaskResetBtn">Reset Form</button>
      </form>
      <div id="ganttTaskList" class="section-group"></div>
      <div id="ganttContainer"></div>
    </section>
  </main>
</body>
</html>
